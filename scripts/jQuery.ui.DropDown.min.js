(function(n){var t,i,r;window.getComputedStyle||(window.getComputedStyle=function(n){return this.el=n,this.getPropertyValue=function(t){var i=/(\-([a-z]){1})/g;return t=="float"&&(t="styleFloat"),i.test(t)&&(t=t.replace(i,function(){return arguments[2].toUpperCase()})),n.currentStyle[t]?n.currentStyle[t]:null},this}),Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var i=this.length>>>0,t=Number(arguments[1])||0;for(t=t<0?Math.ceil(t):Math.floor(t),t<0&&(t+=i);t<i;t++)if(t in this&&this[t]===n)return t;return-1}),n.widget("kodingsykosis.DropDown",{options:{other:!1,listSize:10,maxHeight:350,emptyText:"Choose Item",allowEmpty:!0,ignoreEmptyOptions:!0,emptyOption:"^$|^0$",filterEx:"^{0}",filterOpt:"i",duration:120,viewPort:window},keyTraps:[127,27,38,40,13,8,33,34],currentFilter:"",_create:function(){var i=this,t;this.wrap=n("<div>"),this.name=this.element.attr("name"),this.element.addClass("ui-dropdown-source"),this.element.hide(),t=window.getComputedStyle(this.element[0]),this.wrap.css({width:t.width,height:t.height,float:t.float,position:t.position,top:t.top,left:t.left,right:t.right,bottom:t.bottom,lineHeight:t.lineHeight,fontSize:t.fontSize}),this.element.wrap(this.wrap),this.wrap=this.element.parent(),this.container=this._addContainer().append(this._addInputs()),this.wrap.after(this.value),this.element.removeAttr("name").before(this.container),this.dropDownContainer=this._addDropDown().appendTo(this.container),this.list=this._addList(),this.scrollContainer=this._addScrollbar(this.list),this.otherValue=this._addOtherValue(),this.scroll.tinyscrollbar({contentPadding:0}),this.trigger=this._addTrigger().appendTo(this.container),this.refresh(),this.container.notClicked(n.proxy(this.collapse,this)),this.container.mousedown(function(){i.mouseDown=!0}),n(window).mouseup(function(){i.mouseDown=!1}),this.dropDownContainer.hide()},refresh:function(){var u=this._consumeSelect(this.element),i=this._buildMenu(u),r,t;this.list.children("li").remove(),this.list.append(i),this.items=n(i),r=this._getFormValidator(),r&&(t=n.extend({},this.element.rules(),this.options.rules),this._hasProperties(t)||(t=null),this._applyValidation(t)),this._computeContainerSize(),this.selected(this.selected())},selected:function(t){var i=this.list.children(".ui-selected"),r;return typeof t!="undefined"&&(i.length>0&&(i.removeClass("ui-selected").data("menu-item").selected=!1),t.length>0?t=t.data("menu-item"):t.length==0&&(t={value:""}),this.list.children("li").each(function(){var r=n(this),i=r.data("menu-item")||{};i.selected=i.value===t.value,r.toggleClass("ui-selected",i.selected),r.data("menu-item",i)}),this.list.children(".ui-selected").length>0&&this.otherValue&&this.otherValue.val(""),this.value.val(t.value||t.text),r=this.value.val()=="",this.display.val(r?this.options.emptyText:t.text).toggleClass("ui-dropdown-display-empty",r),this._updScrollPosition(i)),i},expand:function(){if(!this.dropDownContainer.is(":visible")){var t=this._computeViewPortConstraints();this.dropDownContainer.css(t.css).show("slide",{direction:t.direction},t.duration).promise().always(n.proxy(this._computeContainerSize,this)),this._updScrollPosition()}},collapse:function(){if(this.dropDownContainer.is(":visible")){var n=this._computeViewPortConstraints();this.dropDownContainer.css(n.css).hide("slide",{direction:n.direction},n.duration),this.items.filter(".ui-state-hover").removeClass("ui-state-hover"),this.clearFilter()}},toggle:function(){var n=this.dropDownContainer.is(":visible");n?this.collapse():this.display.focus()},filter:function(t){var r;if(t.length==0)return this.clearFilter();var u=this.options.filterEx.replace("{0}",t),f=this.options.filterOpt,e=new RegExp(u,f),i=this.items.filter(function(){return e.test(n(this).text())}).show();return i.length==0?(this.display.effect("highlight",{color:"#C6244A"},200),n.debug("debug",this.widgetName,"No matches"),null):(this.list.children().not(i).hide(),this.list.children(".ui-state-hover").removeClass("ui-state-hover"),r=i.first().addClass("ui-state-hover").text(),this.display.val(r),this._setSelection(this.display[0],Math.min(t.length,r.length),r.length),this.currentFilter=t,this._updScrollPosition(),i)},clearFilter:function(){this.currentFilter="",this.list.children().show().removeClass("ui-state-hover"),this.display[0].selectionStart=0,this.display[0].selectionEnd=0},_consumeSelect:function(t){var i=[],r=this.options.ignoreEmptyOptions,u=new RegExp(this.options.emptyOption,"i");return t.children("option").each(function(){var t=n(this);u.test(t.val())&&r||i.push({text:t.text(),value:t.val(),selected:t.is(":selected"),cls:t.attr("class")})}),i},_buildMenu:function(t){var i=[],r;return this.options.allowEmpty&&(r=n("<li>").data("menu-item",{text:"",value:"",selected:!1}).attr("value","").append("&nbsp;").on({mouseenter:function(){n(this).addClass("ui-state-hover")},mouseleave:function(){n(this).removeClass("ui-state-hover")}}),i.push(r[0])),n.each(t,function(t,r){var u=n("<li>").data("menu-item",r).attr("value",r.value);r.icon&&u.append(n("<span>").appendClass("ui-icon").appendClass(r.icon)),r.cls&&u.addClass(r.cls),u.append(r.text),u.toggleClass("ui-selected",r.selected);u.on({mouseenter:function(){n(this).addClass("ui-state-hover")},mouseleave:function(){n(this).removeClass("ui-state-hover")}});i.push(u[0])}),i},_computeContainerSize:function(){var t=this.options.listSize,n=this.list.children().totalHeight(!0,t);n+=this.list.outerHeight()-this.list.children().totalHeight(!0),this.scrollContainer.height(n),this.otherValue&&(n+=this.otherValue.outerHeight()+10),this.viewPortSpace>n+this.display.height()?this.dropDownContainer.height(n):this.dropDownContainer.height(this.viewPortSpace),this.scroll.find(".scrollbar").width(10),this.scroll.tinyscrollbar_update("relative"),this.height=n},_computeViewPortConstraints:function(){var n=this._getViewPortBox(),u=this.display.offset(),t=this.display.outerHeight(),i=n.height-t-(u.top-n.scrollTop),r=i>this.height-this.height/3?0:1,f=[t,-this.height];return this.viewPortSpace=i,{direction:["up","down"][r],duration:this.options.duration,css:{top:f[r]}}},_getViewPortBox:function(){var t=n(this.options.viewPort),i=t.height()||0,r=t.width()||0;return{scrollTop:t.scrollTop(),scrollLeft:t.scrollLeft(),width:r,height:i}},_addTrigger:function(){var t=function(t){var i=n(t.delegateTarget||t.target);i.is(".ui-button")&&i.toggleClass("ui-state-hover")};return n("<div>",{"class":"ui-button ui-widget ui-corner-all ui-state-default ui-dropdown-trigger"}).on({click:n.proxy(this.toggle,this),mouseenter:t,mouseleave:t}).append(n("<span>",{"class":"ui-icon ui-icon-triangle-1-s"}))},_addOtherValue:function(){var i=this.element.data("other"),t;return typeof i=="undefined"&&this.options.other===!1?!1:(t=n("<input>",{type:"text",tabindex:-1,"class":"ui-dropdown-othervalue ui-widget ui-widget-content ui-corner-all ui-state-default ignore-validation",placeholder:"Other"}),t.css({width:this.dropDownContainer.width()-8}).on({keydown:n.proxy(this._onOtherKeyDown,this),focus:function(){n(this).addClass("ui-state-hover")},blur:n.proxy(this._onLostFocus,this)}).data("menu-item",{text:i,value:i,selected:!0}).appendTo(this.dropDownContainer),n.validation&&t.rules({required:!1}),t)},_addScrollbar:function(t){return n("<div>").css({position:"relative",width:"100%",padding:"2px",boxSizing:"border-box"}).append(this.scroll=n("<div>",{"class":"tinyscrollbar"}).append(t)).appendTo(this.dropDownContainer)},_addInputs:function(){this.value=n("<input>",{type:"hidden",name:this.name,"class":"ui-dropdown-value"});this.value.on({change:n.proxy(this._onValueChanged,this),validationrules:n.proxy(this._onValidationRules,this)});this.display=n("<input>",{type:"text",readonly:"readonly","class":"ui-widget ui-widget-content ui-corner-all ui-dropdown-display ignore-validation",placeholder:this.options.emptyText});this.display.attr("autocomplete","off").css({width:"100%",boxSizing:"border-box",height:"26px",margin:"0px"}).on({focus:n.proxy(this.expand,this),blur:n.proxy(this._onLostFocus,this),keypress:n.proxy(this._onKeyPress,this)});return this.display},_addContainer:function(){var t=n("<div>",{"class":"ui-dropdown-container noSelect"});t.on({keydown:n.proxy(this._onKeyDown,this)});return t},_addDropDown:function(){var t=n("<div>",{"class":"ui-dropdown-container-inner"});return t.css({width:"100%",zIndex:1e3})},_addList:function(){var t=n("<ul>",{"class":"ui-dropdown-list"});return t.on({click:n.proxy(this._onItemClicked,this)})},_applyValidation:function(t){var i=this._getFormValidator();if(i)try{this._injectElement(),this.display.rules("remove"),this.display.rules({required:!1}),t&&this.value.on({validationerror:n.proxy(this._onValidationError,this),validationsuccess:n.proxy(this._onValidationSuccess,this)}).rules(t)}catch(r){n.debug("error",this.widgetName,r)}},_hasProperties:function(n){for(var t in n)if(n.hasOwnProperty(t))return!0;return!1},_getFormValidator:function(){return n(this.element[0].form).data("validator")},_injectElement:function(){var t=this._getFormValidator(),i=n.validator.prototype.elements,f=i.call(t),r=this.value,u=this.display;f.is(r)||(n.validator.prototype.elements=function(){var n=i.call(t).not(u);return u.is(":visible")?n.add(r):n})},_updScrollPosition:function(n){var i=n||this.selected(),r,t;if(i.length==0){this.scroll.tinyscrollbar_update(0);return}r=this.scroll.find(".content").height()-this.scrollContainer.height(),t=i.position().top-this.scrollContainer.height()/2+i.outerHeight()/2,t=Math.min(Math.max(t,0),Math.abs(r)),this.scroll.tinyscrollbar_update(t)},_setSelection:function(t,i,r){if(t=n(t)[0],t.setSelectionRange&&t.setSelectionRange(i,r),t.createTextRange){var u=t.createTextRange();u.moveStart("character",i),u.moveEnd("character",r),u.select()}else t.selectionStart=i,t.selectionEnd=r},_onValueChanged:function(){var t=this.value.val(),n=this.list.find('li[value="'+t+'"]'),i,r;(n.length==0&&this.otherValue&&(n=this.otherValue,this.otherValue.val(t),i=n.data("menu-item"),i.text=t),n.length!=0)&&(r=n.data("menu-item"),this.selected(r),this.collapse())},_onKeyDown:function(n){if(this.keyTraps.indexOf(n.which)==-1)return!0;n.preventDefault();var i=this.list.is(":visible"),r=this.items.length,u=this.options.listSize,t=this.items.add(this.otherValue).filter(".ui-state-hover:visible").first();t.length==0&&(t=this.selected());switch(n.which){case 127:return this.clearFilter();case 27:return this.collapse();case 38:if(!t.is("li")&&i)return!1;t.is("li")&&t.index()>0&&t.length>0?i&&(t=t.prevAll(":visible:first")):t=this.items.filter(":visible:last");break;case 40:if(!t.is("li")&&i)return!1;t.is("li")&&t.index()<r-1&&t.length>0?i&&(t=t.nextAll(":visible:first")):t=this.items.filter(":visible:first");break;case 13:if(i)return t.length>0&&t.val()!=""&&this.selected(t),this.collapse();break;case 8:if(this.currentFilter.length>0)return this.filter(this.currentFilter.substr(0,this.currentFilter.length-1));break;case 33:t=this.items.eq(Math.max(t.index()-u,0));break;case 34:t=this.items.eq(Math.min(t.index()+u,r-1))}this.items.filter(".ui-state-hover").removeClass("ui-state-hover"),i||this.expand(),t.addClass("ui-state-hover"),this._updScrollPosition(t)},_onKeyPress:function(n){n.which>31&&n.which<127&&this.filter(this.currentFilter+String.fromCharCode(n.which))},_onOtherKeyDown:function(n){switch(n.which){case 13:case 9:var t=this.otherValue.data("menu-item");t.text=this.otherValue.val(),this.otherValue.data("menu-item",t);case 38:case 40:n.preventDefault(),this._onKeyDown(n);return}this.items.filter(".ui-state-hover").removeClass("ui-state-hover"),this.otherValue.addClass("ui-state-hover")},_onItemClicked:function(t){var i=n(t.target),r;i.is("li")&&(t.preventDefault(),n.debug("debug",this.widgetName,"Item Clicked",i),r=i.data("menu-item"),r)&&(this.selected(r),this.collapse())},_onLostFocus:function(t){var r=n(t.relatedTarget),i;this.mouseDown&&!r.is("li")||this.display.is(":focus")||(i=this.items.filter(".ui-state-hover"),i.length>0&&this.selected(i),this.collapse())},_onValidationError:function(n,t){var i=this.value.is("."+t.errorClass);return this.display.toggleClass(t.errorClass,i).toggleClass(t.validClass,!i),!1},_onValidationSuccess:function(n,t){var i=this.value.is("."+t.errorClass);return this.display.toggleClass(t.errorClass,i).toggleClass(t.validClass,!i),!1},_onValidationRules:function(n,t){(t.command=="add"||t.command=="remove")&&this._applyValidation()}}),n.validator&&(t=n.validator.defaults.highlight,i=n.validator.defaults.unhighlight,n.extend(!0,n.validator.defaults,{ignore:n.validator.defaults.ignore+",.ignore-validation",highlight:function(i,r,u){t(i,r,u);var f={errorClass:r,validClass:u};n(i).trigger("validationerror",f)},unhighlight:function(t,r,u){i(t,r,u);var f={errorClass:r,validClass:u};n(t).trigger("validationsuccess",f)}}),n.fn.rules&&(r=n.fn.rules,n.fn.rules=function(n,t){var i=r.call(this,n,t);return this.trigger("validationrules",{command:n,argument:t}),i}))})(jQuery);
//@ sourceMappingURL=jQuery.ui.DropDown.min.js.map